(() => {
				global.__filename = import.meta.url.replace('file:///', '');
				let ___demo___ = __filename.split('/')
				___demo___.pop();
				global.__dirname = ___demo___.join('/')
			})();
import"reflect-metadata";import"dotenv-defaults/config.js";import{_serializeData as le}from"@builder.io/qwik";import{getNotFound as ce}from"./@qwik-city-not-found-paths.js";import fe from"./@qwik-city-plan.mjs";import{isStaticPath as ue}from"./@qwik-city-static-paths.js";import{createReadStream as me,readFileSync as F}from"fs";import{join as D,extname as de}from"path";import{fileURLToPath as pe}from"url";import{TextEncoderStream as he,TextDecoderStream as ge,WritableStream as ye,ReadableStream as _e}from"stream/web";import{fetch as be,Headers as we,Request as ve,Response as xe,FormData as Se}from"undici";import Re from"crypto";import R from"express";import Te from"compression";import{join as j}from"path/win32";import Pe from"./entry.ssr.mjs";import{Get as E,UseBefore as Ae,QueryParam as De,ContentType as $e,Controller as Oe,useExpressServer as We}from"routing-controllers";import"./assets/index.qwik-7b9285e8.mjs";import"@builder.io/qwik/jsx-runtime";import"zod";import"@builder.io/qwik/server";var Y=class extends Error{constructor(e,t){super(t),this.status=e}};function He(e,t){let r="Server Error";return t!=null&&(typeof t.message=="string"?r=t.message:r=String(t)),je(e,r)}function je(e,t){typeof e!="number"&&(e=500),typeof t=="string"?t=Me(t):t="";const r=typeof t=="string"?"600px":"300px",a=e>=500?Ee:Ce;return`<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${t}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${a}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${r}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${a}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${a}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${t}</span></p></body>
</html>`}var ke=/[&<>]/g,Me=e=>e.replace(ke,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),Ce="#006ce9",Ee="#713fc2",U={lax:"Lax",none:"None",strict:"Strict"},Le={seconds:1,minutes:1*60,hours:1*60*60,days:1*60*60*24,weeks:1*60*60*24*7},qe=(e,t,r)=>{const a=[`${e}=${t}`];return typeof r.domain=="string"&&a.push(`Domain=${r.domain}`),typeof r.maxAge=="number"?a.push(`Max-Age=${r.maxAge}`):Array.isArray(r.maxAge)?a.push(`Max-Age=${r.maxAge[0]*Le[r.maxAge[1]]}`):typeof r.expires=="number"||typeof r.expires=="string"?a.push(`Expires=${r.expires}`):r.expires instanceof Date&&a.push(`Expires=${r.expires.toUTCString()}`),r.httpOnly&&a.push("HttpOnly"),typeof r.path=="string"&&a.push(`Path=${r.path}`),r.sameSite&&U[r.sameSite]&&a.push(`SameSite=${U[r.sameSite]}`),r.secure&&a.push("Secure"),a.join("; ")},Ie=e=>{const t={};if(typeof e=="string"&&e!==""){const r=e.split(";");for(const a of r){const n=a.split("=");n.length>1&&(t[decodeURIComponent(n[0].trim())]=decodeURIComponent(n[1].trim()))}}return t},A=Symbol("request-cookies"),C=Symbol("response-cookies"),K,Fe=class{constructor(e){this[K]={},this[A]=Ie(e)}get(e){const t=this[A][e];return t?{value:t,json(){return JSON.parse(t)},number(){return Number(t)}}:null}getAll(){return Object.keys(this[A]).reduce((e,t)=>(e[t]=this.get(t),e),{})}has(e){return!!this[A][e]}set(e,t,r={}){const a=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[C][e]=qe(e,a,r)}delete(e,t){this.set(e,"deleted",{...t,maxAge:0})}headers(){return Object.values(this[C])}};K=C;var $=class{},O=class extends ${},N=new WeakMap,Ue="qaction";function Ne(e){const{url:t,params:r,request:a,status:n,locale:i}=e,s={};a.headers.forEach((f,o)=>s[o]=f);const l=q(e),c=e.sharedMap.get("actionFormData");return{url:new URL(t.pathname+t.search,t).href,requestHeaders:s,locale:i(),qwikcity:{params:{...r},loadedRoute:at(e),response:{status:n(),loaders:W(e),action:l,formData:c}}}}var Qe=(e,t,r,a)=>{const n=[],i=[],s=!!(t&&ze(t[1]));return e&&Q(n,i,e,s,r),t&&(s&&(i.push(Je),i.push(Ve)),Q(n,i,t[1],s,r),s&&(n.length+B.length>0&&i.push(B(n)),i.push(a))),i.length>0&&i.unshift(Ye),i},Q=(e,t,r,a,n)=>{for(const i of r){typeof i.onRequest=="function"?t.push(i.onRequest):Array.isArray(i.onRequest)&&t.push(...i.onRequest);let s;switch(n){case"GET":{s=i.onGet;break}case"POST":{s=i.onPost;break}case"PUT":{s=i.onPut;break}case"PATCH":{s=i.onPatch;break}case"DELETE":{s=i.onDelete;break}case"OPTIONS":{s=i.onOptions;break}case"HEAD":{s=i.onHead;break}}if(typeof s=="function"?t.push(s):Array.isArray(s)&&t.push(...s),a){const l=Object.values(i).filter(c=>Be(c,"server_loader"));e.push(...l)}}},Be=(e,t)=>e&&typeof e=="object"&&e.__brand===t;function B(e){return async t=>{if(t.headersSent){t.exit();return}const{method:r}=t,a=W(t);if(r==="POST"){const n=t.query.get(Ue),i=globalThis._qwikActionsMap;if(n&&i){const s=i.get(n);if(s){nt(t,n);const l=se(t.request.headers),c=t.request.clone();let f;if(l){const m=await c.formData();t.sharedMap.set("actionFormData",m),f=Ge(m)}else f=await c.json();let o=!1;if(s.__schema){const d=await(await s.__schema).safeParseAsync(f);d.success?f=d.data:(o=!0,globalThis.qDev&&console.error(`
VALIDATION ERROR
action$() zod validated failed`,`

  - Received:`,f,`
  - Issues:`,d.error.issues),a[n]={__brand:"fail",...d.error.flatten()})}if(!o){const m=await s.__qrl(f,t);a[n]=m}}}}e.length>0&&await Promise.all(e.map(n=>{const i=n.__qrl.getHash();return a[i]=Promise.resolve().then(()=>n.__qrl(t)).then(s=>a[i]=typeof s=="function"?s():s)}))}}var Ge=e=>{const t={};return e.forEach((r,a)=>{const n=a.split(".").filter(s=>s);let i=t;for(let s=0;s<n.length;s++){let l=n[s];s===n.length-1?l.endsWith("[]")?(l=l.slice(0,-2),i[l]=i[l]||[],i[l].push(r)):i[l]=r:i=i[l]={}}}),t};function Je(e){const t=tt(e),r=rt(e),{pathname:a,url:n}=e;if(!ne(a)&&a!==r&&!a.endsWith(".html")){if(t){if(!a.endsWith("/"))throw e.redirect(302,a+"/"+n.search)}else if(a.endsWith("/"))throw e.redirect(302,a.slice(0,a.length-1)+n.search)}}function ze(e){const t=e[e.length-1];return t&&typeof t.default=="function"}function V(e,t){return e.pathname.endsWith(v)?e.pathname.slice(0,-v.length+(t?1:0))+e.search:e.pathname}var X=new TextEncoder;function Ye({method:e,url:t,request:r,error:a}){if(e==="POST"&&r.headers.get("origin")!==t.origin&&se(r.headers))throw a(403,`Cross-site ${r.method} form submissions are forbidden`)}function Ke(e,t){return async r=>{if(r.headersSent||r.pathname.endsWith(v))return;r.request.headers.forEach((m,d)=>m);const n=r.headers;n.has("Content-Type")||n.set("Content-Type","text/html; charset=utf-8");const{readable:i,writable:s}=new TextEncoderStream,l=r.getWritableStream(),c=i.pipeTo(l),f=s.getWriter(),o=r.status();try{const m=st(r)==="static",d=await e({stream:f,serverData:Ne(r),containerAttributes:{["q:render"]:m?"static":""}}),h={loaders:W(r),action:q(r),status:o!==200?o:200,href:V(r.url,!0)};(typeof d).html==="string"&&await f.write(d.html),r.sharedMap.set("qData",h)}finally{await f.ready,await f.close(),await c}}}async function Ve(e){if(ne(e.pathname)){try{await e.next()}catch(c){if(!(c instanceof O))throw c}if(e.headersSent||e.exited)return;const r=e.status(),a=e.headers.get("Location");if(r>=301&&r<=308&&a){const c=Xe(a);if(c){e.headers.set("Location",c),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}e.request.headers.forEach((c,f)=>c),e.headers.set("Content-Type","application/json; charset=utf-8");const i={loaders:W(e),action:q(e),status:r!==200?r:200,href:V(e.url,!0),redirect:a??void 0},s=e.getWritableStream().getWriter(),l=await le(i);s.write(X.encode(l)),e.sharedMap.set("qData",i),s.close()}}function Xe(e){if(e.startsWith("/")){const t=v,r=new URL(e,"http://localhost");return(r.pathname.endsWith("/")?r.pathname.slice(0,-1):r.pathname)+(t.startsWith("/")?"":"/")+t+r.search}else return}function Ze(e){const t=[];return e==="day"?e=60*60*24:e==="week"?e=60*60*24*7:e==="month"?e=60*60*24*30:e==="year"?e=60*60*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:60*60*24*365,staleWhileRevalidate:60*60*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e,staleWhileRevalidate:e}),e.immutable&&t.push("immutable"),e.maxAge&&t.push(`max-age=${e.maxAge}`),e.sMaxAge&&t.push(`s-maxage=${e.sMaxAge}`),e.noStore&&t.push("no-store"),e.noCache&&t.push("no-cache"),e.private&&t.push("private"),e.public&&t.push("public"),e.staleWhileRevalidate&&t.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),t.join(", ")}var Z=Symbol("RequestEvLoaders"),k=Symbol("RequestEvLocale"),ee=Symbol("RequestEvMode"),_=Symbol("RequestEvStatus"),te=Symbol("RequestEvRoute"),L=Symbol("RequestEvAction"),re=Symbol("RequestEvTrailingSlash"),ae=Symbol("RequestEvBasePathname");function et(e,t,r,a=!0,n="/",i){const{request:s,platform:l,env:c}=e,f=new Fe(s.headers.get("cookie")),o=new Headers,m=new URL(s.url);let d=-1,h=null;const b=async()=>{for(d++;d<r.length;){const u=r[d],p=u(g);p instanceof Promise&&await p,d++}},y=()=>{if(h!==null)throw new Error("Response already sent")},x=(u,p)=>{if(y(),typeof u=="number"){g[_]=u;const S=g.getWritableStream().getWriter();S.write(typeof p=="string"?X.encode(p):p),S.close()}else{const P=u.status;if(g[_]=P,u.headers.forEach((S,oe)=>{o.append(oe,S)}),u.body){const S=g.getWritableStream();u.body.pipeTo(S)}else{if(P>=300&&P<400)return new O;g.getWritableStream().getWriter().close()}}return new $},H={},g={[Z]:H,[k]:e.locale,[ee]:e.mode,[_]:200,[L]:void 0,[re]:a,[ae]:n,[te]:t,cookie:f,headers:o,env:c,method:s.method,params:(t==null?void 0:t[0])??{},pathname:m.pathname,platform:l,query:m.searchParams,request:s,url:m,sharedMap:new Map,get headersSent(){return h!==null},get exited(){return d>=G},next:b,exit:()=>(d=G,new $),cacheControl:u=>{y(),o.set("Cache-Control",Ze(u))},getData:async u=>{const p=u.__qrl.getHash();if(u.__brand==="server_loader"&&!(p in H))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");return H[p]},status:u=>typeof u=="number"?(y(),g[_]=u,u):g[_],locale:u=>(typeof u=="string"&&(g[k]=u),g[k]||""),error:(u,p)=>(g[_]=u,o.delete("Cache-Control"),new Y(u,p)),redirect:(u,p)=>(y(),g[_]=u,o.set("Location",p),o.delete("Cache-Control"),u>301&&o.set("Cache-Control","no-store"),new O),fail:(u,p)=>(y(),g[_]=u,o.delete("Cache-Control"),{failed:!0,...p}),text:(u,p)=>(o.set("Content-Type","text/plain; charset=utf-8"),x(u,p)),html:(u,p)=>(o.set("Content-Type","text/html; charset=utf-8"),x(u,p)),json:(u,p)=>(o.set("Content-Type","application/json; charset=utf-8"),x(u,JSON.stringify(p))),send:x,getWritableStream:()=>(h===null&&(h=e.getWritableStream(g[_],o,f,i,g)),h)};return g}function W(e){return e[Z]}function tt(e){return e[re]}function rt(e){return e[ae]}function at(e){return e[te]}function q(e){return e[L]}function nt(e,t){e[L]=t}function st(e){return e[ee]}var G=999999999;function it(e,t,r,a=!0,n="/"){let i;const s=new Promise(c=>i=c),l=et(e,t,r,a,n,i);return{response:s,requestEv:l,completion:ot(l,i)}}async function ot(e,t){try{await e.next()}catch(r){if(r instanceof O)e.getWritableStream().close();else if(r instanceof Y){if(console.error(r),!e.headersSent){const a=He(r.status,r);e.html(r.status,a)}}else if(!(r instanceof $))return r}finally{t(null)}}function lt(e,t){if(e.endsWith(v)){const r=e.length-ct+(t?1:0);e=e.slice(0,r),e===""&&(e="/")}return e}var ne=e=>e.endsWith(v),v="/q-data.json",ct=v.length;function se(e){return ft(e,"application/x-www-form-urlencoded","multipart/form-data")}function ft(e,...t){var r;const a=((r=e.get("content-type"))==null?void 0:r.split(";",1)[0].trim())??"";return t.includes(a)}var ut=async(e,t,r,a)=>{if(Array.isArray(e))for(const n of e){const i=n[0].exec(a);if(i){const s=n[1],l=dt(n[2],i),c=n[4],f=new Array(s.length),o=[],m=mt(t,a);let d;return s.forEach((h,b)=>{J(h,o,y=>f[b]=y,r)}),J(m,o,h=>d=h==null?void 0:h.default,r),o.length>0&&await Promise.all(o),[l,f,d,c]}}return null},J=(e,t,r,a)=>{if(typeof e=="function"){const n=N.get(e);if(n)r(n);else{const i=e();typeof i.then=="function"?t.push(i.then(s=>{a!==!1&&N.set(e,s),r(s)})):i&&r(i)}}},mt=(e,t)=>{if(e){t=t.endsWith("/")?t:t+"/";const r=e.find(a=>a[0]===t||t.startsWith(a[0]+(t.endsWith("/")?"":"/")));if(r)return r[1]}},dt=(e,t)=>{const r={};let a,n;if(e)for(a=0;a<e.length;a++)n=t?t[a+1]:"",r[e[a]]=n.endsWith("/")?n.slice(0,-1):n;return r};async function pt(e,t){const{render:r,qwikCityPlan:a}=t,{routes:n,serverPlugins:i,menus:s,cacheModules:l,trailingSlash:c,basePathname:f}=a,o=e.url.pathname,m=lt(o,c),d=await ht(i,n,s,l,m,e.request.method,r);return d?it(e,d[0],d[1],c,f):null}async function ht(e,t,r,a,n,i,s){const l=await ut(t,r,a,n),c=Qe(e,l,i,Ke(s));return c.length>0?[l,c]:null}var{ORIGIN:gt,PROTOCOL_HEADER:z,HOST_HEADER:yt="host"}=process.env;function _t(e){const t=e.headers,r=z&&t[z]||(e.socket.encrypted||e.connection.encrypted?"https":"http"),a=t[yt];return`${r}://${a}`}function M(e){const t=gt??_t(e);return new URL(e.url||"/",t)}async function bt(e,t,r,a){const n=new Headers,i=t.headers;for(const o in i){const m=i[o];if(typeof m=="string")n.set(o,m);else if(Array.isArray(m))for(const d of m)n.append(o,d)}const s=async function*(){for await(const o of t)yield o},l=t.method==="HEAD"||t.method==="GET"?void 0:s(),c={method:t.method,headers:n,body:l,duplex:"half"};return{mode:a,url:e,request:new Request(e.href,c),env:{get(o){return process.env[o]}},getWritableStream:(o,m,d)=>{r.statusCode=o,m.forEach((y,x)=>r.setHeader(x,y));const h=d.headers();return h.length>0&&r.setHeader("Set-Cookie",h),new WritableStream({write(y){r.write(y)},close(){r.end()}})},platform:{ssr:!0,node:process.versions.node},locale:void 0}}var wt={"3gp":"video/3gpp","3gpp":"video/3gpp",asf:"video/x-ms-asf",asx:"video/x-ms-asf",avi:"video/x-msvideo",avif:"image/avif",bmp:"image/x-ms-bmp",css:"text/css",flv:"video/x-flv",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",jng:"image/x-jng",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",kar:"audio/midi",m4a:"audio/x-m4a",m4v:"video/x-m4v",mid:"audio/midi",midi:"audio/midi",mng:"video/x-mng",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",ogg:"audio/ogg",pdf:"application/pdf",png:"image/png",rar:"application/x-rar-compressed",shtml:"text/html",svg:"image/svg+xml",svgz:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",txt:"text/plain",wbmp:"image/vnd.wap.wbmp",webm:"video/webm",webp:"image/webp",wmv:"video/x-ms-wmv",woff:"font/woff",woff2:"font/woff2",xml:"text/xml",zip:"application/zip"};function vt(){typeof global<"u"&&typeof globalThis.fetch!="function"&&typeof process<"u"&&process.versions.node&&(globalThis.fetch=be,globalThis.Headers=we,globalThis.Request=ve,globalThis.Response=xe,globalThis.FormData=Se),typeof globalThis.TextEncoderStream>"u"&&(globalThis.TextEncoderStream=he,globalThis.TextDecoderStream=ge),typeof globalThis.WritableStream>"u"&&(globalThis.WritableStream=ye,globalThis.ReadableStream=_e),typeof globalThis.crypto>"u"&&(globalThis.crypto=Re.webcrypto)}function xt(e){var t;vt();const r=((t=e.static)==null?void 0:t.root)??D(pe(import.meta.url),"..","..","dist");return{router:async(s,l,c)=>{try{const f=await bt(M(s),s,l,"server"),o=await pt(f,e);if(o){const m=await o.completion;if(m)throw m;if(o.requestEv.headersSent)return}c()}catch(f){console.error(f),c(f)}},notFound:async(s,l,c)=>{try{const f=M(s),o=ce(f.pathname);l.writeHead(404,{"Content-Type":"text/html; charset=utf-8","X-Not-Found":f.pathname}),l.end(o)}catch(f){console.error(f),c(f)}},staticFile:async(s,l,c)=>{var f;try{const o=M(s);if(ue(s.method||"GET",o)){const m=D(r,o.pathname),d=me(m),h=de(o.pathname).replace(/^\./,""),b=wt[h];b&&l.setHeader("Content-Type",b),(f=e.static)!=null&&f.cacheControl&&l.setHeader("Cache-Control",e.static.cacheControl),d.on("error",c),d.pipe(l);return}return c()}catch(o){console.error(o),c(o)}}}}(()=>{global.__filename=import.meta.url.replace("file:///","");let e=__filename.split("/");e.pop(),global.__dirname=e.join("/")})();class St{constructor(){}find(t){return`get user ${t} ok`}}(()=>{global.__filename=import.meta.url.replace("file:///","");let e=__filename.split("/");e.pop(),global.__dirname=e.join("/")})();var Rt=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,Pt=(e,t,r,a)=>{for(var n=a>1?void 0:a?Tt(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(n=(a?s(t,r,n):s(n))||n);return a&&n&&Rt(t,r,n),n},At=(e,t)=>(r,a)=>t(r,a,e);class ie{constructor(t){this.userService=t,this.userService=new St}find(t){return this.userService.find(t)}}Pt([E(),Ae(async(e,t,r)=>{console.log(e.path),r()}),At(0,De("uid"))],ie.prototype,"find",1);(()=>{global.__filename=import.meta.url.replace("file:///","");let e=__filename.split("/");e.pop(),global.__dirname=e.join("/")})();var Dt=Object.defineProperty,$t=Object.getOwnPropertyDescriptor,I=(e,t,r,a)=>{for(var n=a>1?void 0:a?$t(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(n=(a?s(t,r,n):s(n))||n);return a&&n&&Dt(t,r,n),n};let T=class{main(){return F(D(global.__dirname,"../client/index.html"),"utf-8")}icon(){return F(D(global.__dirname,"../client/favicon.ico"),"utf-8")}};I([E("/")],T.prototype,"main",1);I([E("/favicon.ico"),$e("image/x-icon")],T.prototype,"icon",1);T=I([Oe()],T);(()=>{global.__filename=import.meta.url.replace("file:///","");let e=__filename.split("/");e.pop(),global.__dirname=e.join("/")})();const Ot={classTransformer:!0,controllers:[T,ie]};(()=>{global.__filename=import.meta.url.replace("file:///","");let e=__filename.split("/");e.pop(),global.__dirname=e.join("/")})();class w{static async push(t){const r=new Date;console.log(`${r.getHours()}:${r.getMinutes()}:${r.getSeconds()} ${t}`)}static async log(t,r,a){console.log(`${new Date().toLocaleDateString()} [${r.toLocaleUpperCase()}] ${t}`)}static async run(t){console.log(await t())}}(()=>{global.__filename=import.meta.url.replace("file:///","");let e=__filename.split("/");e.pop(),global.__dirname=e.join("/")})();const Wt=async()=>{w.push("正在初始化服务器...");const e=R();e.use(Te()),w.push("正在托管client静态资源..."),e.use("/assets",R.static(j(global.__dirname,"../client/assets"))),w.push("正在托管ssr静态资源..."),e.use("/build",R.static(j(global.__dirname,"./build"),{immutable:!0,maxAge:"1y"})),e.use(R.static(j(global.__dirname,"../ssr"),{redirect:!1})),w.push("正在加载ssr路由...");const{router:t,notFound:r}=xt({render:Pe,qwikCityPlan:fe});e.use(t),e.use(R.json()),e.use(R.urlencoded({extended:!0})),w.push("正在加载服务器路由..."),We(e,Ot),e.listen(3e3,Ht)};function Ht(){w.push(`当前服务器位于 ${process.env.DEV_ENV?"开发环境中":"生产环境中 "}`),w.push("\x1B[4mhttp://127.0.0.1:3000\x1B[0m")}Wt();
