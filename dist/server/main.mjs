var Qe=Object.defineProperty;var ze=(e,t,r)=>t in e?Qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var i=(e,t,r)=>(ze(e,typeof t!="symbol"?t+"":t,r),r);import"reflect-metadata";import{fileURLToPath as Pe}from"url";import{_serializeData as Ge}from"@builder.io/qwik";import{getNotFound as Je}from"./@qwik-city-not-found-paths.js";import Ye from"./@qwik-city-plan.mjs";import{isStaticPath as Ke}from"./@qwik-city-static-paths.js";import{createReadStream as Ve}from"fs";import{join as J,extname as Xe}from"path";import{TextEncoderStream as Ze,TextDecoderStream as ke,WritableStream as et,ReadableStream as tt}from"stream/web";import{fetch as rt,Headers as at,Request as ot,Response as nt,FormData as st}from"undici";import it from"crypto";import ct from"./entry.ssr.mjs";import F,{Router as Oe}from"express";import lt from"compression";import{join as B}from"path/win32";import{validate as pt}from"email-validator";import{readFile as oe}from"fs/promises";import{PrimaryGeneratedColumn as E,Column as f,Entity as W,ManyToOne as Z,OneToOne as ue,JoinColumn as Te,OneToMany as k,DataSource as ut}from"typeorm";import"./assets/index.qwik-d65df070.mjs";import"@builder.io/qwik/jsx-runtime";import"zod";import"@builder.io/qwik/server";var $e=class extends Error{constructor(e,t){super(t),this.status=e}};function ft(e,t){let r="Server Error";return t!=null&&(typeof t.message=="string"?r=t.message:r=String(t)),dt(e,r)}function dt(e,t){typeof e!="number"&&(e=500),typeof t=="string"?t=mt(t):t="";const r=typeof t=="string"?"600px":"300px",o=e>=500?yt:gt;return`<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${t}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${o}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${r}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${o}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${o}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${t}</span></p></body>
</html>`}var ht=/[&<>]/g,mt=e=>e.replace(ht,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),gt="#006ce9",yt="#713fc2",ge={lax:"Lax",none:"None",strict:"Strict"},vt={seconds:1,minutes:1*60,hours:1*60*60,days:1*60*60*24,weeks:1*60*60*24*7},bt=(e,t,r)=>{const o=[`${e}=${t}`];return typeof r.domain=="string"&&o.push(`Domain=${r.domain}`),typeof r.maxAge=="number"?o.push(`Max-Age=${r.maxAge}`):Array.isArray(r.maxAge)?o.push(`Max-Age=${r.maxAge[0]*vt[r.maxAge[1]]}`):typeof r.expires=="number"||typeof r.expires=="string"?o.push(`Expires=${r.expires}`):r.expires instanceof Date&&o.push(`Expires=${r.expires.toUTCString()}`),r.httpOnly&&o.push("HttpOnly"),typeof r.path=="string"&&o.push(`Path=${r.path}`),r.sameSite&&ge[r.sameSite]&&o.push(`SameSite=${ge[r.sameSite]}`),r.secure&&o.push("Secure"),o.join("; ")},_t=e=>{const t={};if(typeof e=="string"&&e!==""){const r=e.split(";");for(const o of r){const a=o.split("=");a.length>1&&(t[decodeURIComponent(a[0].trim())]=decodeURIComponent(a[1].trim()))}}return t},K=Symbol("request-cookies"),ie=Symbol("response-cookies"),De,wt=class{constructor(e){this[De]={},this[K]=_t(e)}get(e){const t=this[K][e];return t?{value:t,json(){return JSON.parse(t)},number(){return Number(t)}}:null}getAll(){return Object.keys(this[K]).reduce((e,t)=>(e[t]=this.get(t),e),{})}has(e){return!!this[K][e]}set(e,t,r={}){const o=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[ie][e]=bt(e,o,r)}delete(e,t){this.set(e,"deleted",{...t,maxAge:0})}headers(){return Object.values(this[ie])}};De=ie;var V=class{},X=class extends V{},ye=new WeakMap,Rt="qaction";function xt(e){const{url:t,params:r,request:o,status:a,locale:s}=e,n={};o.headers.forEach((u,c)=>n[c]=u);const l=de(e),p=e.sharedMap.get("actionFormData");return{url:new URL(t.pathname+t.search,t).href,requestHeaders:n,locale:s(),qwikcity:{params:{...r},loadedRoute:qt(e),response:{status:a(),loaders:ee(e),action:l,formData:p}}}}var St=(e,t,r,o)=>{const a=[],s=[],n=!!(t&&$t(t[1]));return e&&ve(a,s,e,n,r),t&&(n&&(s.push(Tt),s.push(At)),ve(a,s,t[1],n,r),n&&(a.length+be.length>0&&s.push(be(a)),s.push(o))),s.length>0&&s.unshift(Dt),s},ve=(e,t,r,o,a)=>{for(const s of r){typeof s.onRequest=="function"?t.push(s.onRequest):Array.isArray(s.onRequest)&&t.push(...s.onRequest);let n;switch(a){case"GET":{n=s.onGet;break}case"POST":{n=s.onPost;break}case"PUT":{n=s.onPut;break}case"PATCH":{n=s.onPatch;break}case"DELETE":{n=s.onDelete;break}case"OPTIONS":{n=s.onOptions;break}case"HEAD":{n=s.onHead;break}}if(typeof n=="function"?t.push(n):Array.isArray(n)&&t.push(...n),o){const l=Object.values(s).filter(p=>Pt(p,"server_loader"));e.push(...l)}}},Pt=(e,t)=>e&&typeof e=="object"&&e.__brand===t;function be(e){return async t=>{if(t.headersSent){t.exit();return}const{method:r}=t,o=ee(t);if(r==="POST"){const a=t.query.get(Rt),s=globalThis._qwikActionsMap;if(a&&s){const n=s.get(a);if(n){Lt(t,a);const l=Le(t.request.headers),p=t.request.clone();let u;if(l){const m=await p.formData();t.sharedMap.set("actionFormData",m),u=Ot(m)}else u=await p.json();let c=!1;if(n.__schema){const d=await(await n.__schema).safeParseAsync(u);d.success?u=d.data:(c=!0,globalThis.qDev&&console.error(`
VALIDATION ERROR
action$() zod validated failed`,`

  - Received:`,u,`
  - Issues:`,d.error.issues),o[a]={__brand:"fail",...d.error.flatten()})}if(!c){const m=await n.__qrl(u,t);o[a]=m}}}}e.length>0&&await Promise.all(e.map(a=>{const s=a.__qrl.getHash();return o[s]=Promise.resolve().then(()=>a.__qrl(t)).then(n=>o[s]=typeof n=="function"?n():n)}))}}var Ot=e=>{const t={};return e.forEach((r,o)=>{const a=o.split(".").filter(n=>n);let s=t;for(let n=0;n<a.length;n++){let l=a[n];n===a.length-1?l.endsWith("[]")?(l=l.slice(0,-2),s[l]=s[l]||[],s[l].push(r)):s[l]=r:s=s[l]={}}}),t};function Tt(e){const t=Et(e),r=Wt(e),{pathname:o,url:a}=e;if(!qe(o)&&o!==r&&!o.endsWith(".html")){if(t){if(!o.endsWith("/"))throw e.redirect(302,o+"/"+a.search)}else if(o.endsWith("/"))throw e.redirect(302,o.slice(0,o.length-1)+a.search)}}function $t(e){const t=e[e.length-1];return t&&typeof t.default=="function"}function je(e,t){return e.pathname.endsWith(q)?e.pathname.slice(0,-q.length+(t?1:0))+e.search:e.pathname}var Ae=new TextEncoder;function Dt({method:e,url:t,request:r,error:o}){if(e==="POST"&&r.headers.get("origin")!==t.origin&&Le(r.headers))throw o(403,`Cross-site ${r.method} form submissions are forbidden`)}function jt(e,t){return async r=>{if(r.headersSent||r.pathname.endsWith(q))return;r.request.headers.forEach((m,d)=>m);const a=r.headers;a.has("Content-Type")||a.set("Content-Type","text/html; charset=utf-8");const{readable:s,writable:n}=new TextEncoderStream,l=r.getWritableStream(),p=s.pipeTo(l),u=n.getWriter(),c=r.status();try{const m=It(r)==="static",d=await e({stream:u,serverData:xt(r),containerAttributes:{["q:render"]:m?"static":""}}),g={loaders:ee(r),action:de(r),status:c!==200?c:200,href:je(r.url,!0)};(typeof d).html==="string"&&await u.write(d.html),r.sharedMap.set("qData",g)}finally{await u.ready,await u.close(),await p}}}async function At(e){if(qe(e.pathname)){try{await e.next()}catch(p){if(!(p instanceof X))throw p}if(e.headersSent||e.exited)return;const r=e.status(),o=e.headers.get("Location");if(r>=301&&r<=308&&o){const p=Mt(o);if(p){e.headers.set("Location",p),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}e.request.headers.forEach((p,u)=>p),e.headers.set("Content-Type","application/json; charset=utf-8");const s={loaders:ee(e),action:de(e),status:r!==200?r:200,href:je(e.url,!0),redirect:o??void 0},n=e.getWritableStream().getWriter(),l=await Ge(s);n.write(Ae.encode(l)),e.sharedMap.set("qData",s),n.close()}}function Mt(e){if(e.startsWith("/")){const t=q,r=new URL(e,"http://localhost");return(r.pathname.endsWith("/")?r.pathname.slice(0,-1):r.pathname)+(t.startsWith("/")?"":"/")+t+r.search}else return}function Ct(e){const t=[];return e==="day"?e=60*60*24:e==="week"?e=60*60*24*7:e==="month"?e=60*60*24*30:e==="year"?e=60*60*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:60*60*24*365,staleWhileRevalidate:60*60*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e,staleWhileRevalidate:e}),e.immutable&&t.push("immutable"),e.maxAge&&t.push(`max-age=${e.maxAge}`),e.sMaxAge&&t.push(`s-maxage=${e.sMaxAge}`),e.noStore&&t.push("no-store"),e.noCache&&t.push("no-cache"),e.private&&t.push("private"),e.public&&t.push("public"),e.staleWhileRevalidate&&t.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),t.join(", ")}var Me=Symbol("RequestEvLoaders"),ne=Symbol("RequestEvLocale"),Ce=Symbol("RequestEvMode"),M=Symbol("RequestEvStatus"),He=Symbol("RequestEvRoute"),fe=Symbol("RequestEvAction"),Ee=Symbol("RequestEvTrailingSlash"),We=Symbol("RequestEvBasePathname");function Ht(e,t,r,o=!0,a="/",s){const{request:n,platform:l,env:p}=e,u=new wt(n.headers.get("cookie")),c=new Headers,m=new URL(n.url);let d=-1,g=null;const O=async()=>{for(d++;d<r.length;){const h=r[d],y=h(_);y instanceof Promise&&await y,d++}},b=()=>{if(g!==null)throw new Error("Response already sent")},A=(h,y)=>{if(b(),typeof h=="number"){_[M]=h;const N=_.getWritableStream().getWriter();N.write(typeof y=="string"?Ae.encode(y):y),N.close()}else{const Y=h.status;if(_[M]=Y,h.headers.forEach((N,Be)=>{c.append(Be,N)}),h.body){const N=_.getWritableStream();h.body.pipeTo(N)}else{if(Y>=300&&Y<400)return new X;_.getWritableStream().getWriter().close()}}return new V},ae={},_={[Me]:ae,[ne]:e.locale,[Ce]:e.mode,[M]:200,[fe]:void 0,[Ee]:o,[We]:a,[He]:t,cookie:u,headers:c,env:p,method:n.method,params:(t==null?void 0:t[0])??{},pathname:m.pathname,platform:l,query:m.searchParams,request:n,url:m,sharedMap:new Map,get headersSent(){return g!==null},get exited(){return d>=_e},next:O,exit:()=>(d=_e,new V),cacheControl:h=>{b(),c.set("Cache-Control",Ct(h))},getData:async h=>{const y=h.__qrl.getHash();if(h.__brand==="server_loader"&&!(y in ae))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");return ae[y]},status:h=>typeof h=="number"?(b(),_[M]=h,h):_[M],locale:h=>(typeof h=="string"&&(_[ne]=h),_[ne]||""),error:(h,y)=>(_[M]=h,c.delete("Cache-Control"),new $e(h,y)),redirect:(h,y)=>(b(),_[M]=h,c.set("Location",y),c.delete("Cache-Control"),h>301&&c.set("Cache-Control","no-store"),new X),fail:(h,y)=>(b(),_[M]=h,c.delete("Cache-Control"),{failed:!0,...y}),text:(h,y)=>(c.set("Content-Type","text/plain; charset=utf-8"),A(h,y)),html:(h,y)=>(c.set("Content-Type","text/html; charset=utf-8"),A(h,y)),json:(h,y)=>(c.set("Content-Type","application/json; charset=utf-8"),A(h,JSON.stringify(y))),send:A,getWritableStream:()=>(g===null&&(g=e.getWritableStream(_[M],c,u,s,_)),g)};return _}function ee(e){return e[Me]}function Et(e){return e[Ee]}function Wt(e){return e[We]}function qt(e){return e[He]}function de(e){return e[fe]}function Lt(e,t){e[fe]=t}function It(e){return e[Ce]}var _e=999999999;function Ut(e,t,r,o=!0,a="/"){let s;const n=new Promise(p=>s=p),l=Ht(e,t,r,o,a,s);return{response:n,requestEv:l,completion:Nt(l,s)}}async function Nt(e,t){try{await e.next()}catch(r){if(r instanceof X)e.getWritableStream().close();else if(r instanceof $e){if(console.error(r),!e.headersSent){const o=ft(r.status,r);e.html(r.status,o)}}else if(!(r instanceof V))return r}finally{t(null)}}function Ft(e,t){if(e.endsWith(q)){const r=e.length-Bt+(t?1:0);e=e.slice(0,r),e===""&&(e="/")}return e}var qe=e=>e.endsWith(q),q="/q-data.json",Bt=q.length;function Le(e){return Qt(e,"application/x-www-form-urlencoded","multipart/form-data")}function Qt(e,...t){var r;const o=((r=e.get("content-type"))==null?void 0:r.split(";",1)[0].trim())??"";return t.includes(o)}var zt=async(e,t,r,o)=>{if(Array.isArray(e))for(const a of e){const s=a[0].exec(o);if(s){const n=a[1],l=Jt(a[2],s),p=a[4],u=new Array(n.length),c=[],m=Gt(t,o);let d;return n.forEach((g,O)=>{we(g,c,b=>u[O]=b,r)}),we(m,c,g=>d=g==null?void 0:g.default,r),c.length>0&&await Promise.all(c),[l,u,d,p]}}return null},we=(e,t,r,o)=>{if(typeof e=="function"){const a=ye.get(e);if(a)r(a);else{const s=e();typeof s.then=="function"?t.push(s.then(n=>{o!==!1&&ye.set(e,n),r(n)})):s&&r(s)}}},Gt=(e,t)=>{if(e){t=t.endsWith("/")?t:t+"/";const r=e.find(o=>o[0]===t||t.startsWith(o[0]+(t.endsWith("/")?"":"/")));if(r)return r[1]}},Jt=(e,t)=>{const r={};let o,a;if(e)for(o=0;o<e.length;o++)a=t?t[o+1]:"",r[e[o]]=a.endsWith("/")?a.slice(0,-1):a;return r};async function Yt(e,t){const{render:r,qwikCityPlan:o}=t,{routes:a,serverPlugins:s,menus:n,cacheModules:l,trailingSlash:p,basePathname:u}=o,c=e.url.pathname,m=Ft(c,p),d=await Kt(s,a,n,l,m,e.request.method,r);return d?Ut(e,d[0],d[1],p,u):null}async function Kt(e,t,r,o,a,s,n){const l=await zt(t,r,o,a),p=St(e,l,s,jt(n));return p.length>0?[l,p]:null}var{ORIGIN:Vt,PROTOCOL_HEADER:Re,HOST_HEADER:Xt="host"}=process.env;function Zt(e){const t=e.headers,r=Re&&t[Re]||(e.socket.encrypted||e.connection.encrypted?"https":"http"),o=t[Xt];return`${r}://${o}`}function se(e){const t=Vt??Zt(e);return new URL(e.url||"/",t)}async function kt(e,t,r,o){const a=new Headers,s=t.headers;for(const c in s){const m=s[c];if(typeof m=="string")a.set(c,m);else if(Array.isArray(m))for(const d of m)a.append(c,d)}const n=async function*(){for await(const c of t)yield c},l=t.method==="HEAD"||t.method==="GET"?void 0:n(),p={method:t.method,headers:a,body:l,duplex:"half"};return{mode:o,url:e,request:new Request(e.href,p),env:{get(c){return process.env[c]}},getWritableStream:(c,m,d)=>{r.statusCode=c,m.forEach((b,A)=>r.setHeader(A,b));const g=d.headers();return g.length>0&&r.setHeader("Set-Cookie",g),new WritableStream({write(b){r.write(b)},close(){r.end()}})},platform:{ssr:!0,node:process.versions.node},locale:void 0}}var er={"3gp":"video/3gpp","3gpp":"video/3gpp",asf:"video/x-ms-asf",asx:"video/x-ms-asf",avi:"video/x-msvideo",avif:"image/avif",bmp:"image/x-ms-bmp",css:"text/css",flv:"video/x-flv",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",jng:"image/x-jng",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",kar:"audio/midi",m4a:"audio/x-m4a",m4v:"video/x-m4v",mid:"audio/midi",midi:"audio/midi",mng:"video/x-mng",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",ogg:"audio/ogg",pdf:"application/pdf",png:"image/png",rar:"application/x-rar-compressed",shtml:"text/html",svg:"image/svg+xml",svgz:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",txt:"text/plain",wbmp:"image/vnd.wap.wbmp",webm:"video/webm",webp:"image/webp",wmv:"video/x-ms-wmv",woff:"font/woff",woff2:"font/woff2",xml:"text/xml",zip:"application/zip"};function tr(){typeof global<"u"&&typeof globalThis.fetch!="function"&&typeof process<"u"&&process.versions.node&&(globalThis.fetch=rt,globalThis.Headers=at,globalThis.Request=ot,globalThis.Response=nt,globalThis.FormData=st),typeof globalThis.TextEncoderStream>"u"&&(globalThis.TextEncoderStream=Ze,globalThis.TextDecoderStream=ke),typeof globalThis.WritableStream>"u"&&(globalThis.WritableStream=et,globalThis.ReadableStream=tt),typeof globalThis.crypto>"u"&&(globalThis.crypto=it.webcrypto)}function rr(e){var t;tr();const r=((t=e.static)==null?void 0:t.root)??J(Pe(import.meta.url),"..","..","dist");return{router:async(n,l,p)=>{try{const u=await kt(se(n),n,l,"server"),c=await Yt(u,e);if(c){const m=await c.completion;if(m)throw m;if(c.requestEv.headersSent)return}p()}catch(u){console.error(u),p(u)}},notFound:async(n,l,p)=>{try{const u=se(n),c=Je(u.pathname);l.writeHead(404,{"Content-Type":"text/html; charset=utf-8","X-Not-Found":u.pathname}),l.end(c)}catch(u){console.error(u),p(u)}},staticFile:async(n,l,p)=>{var u;try{const c=se(n);if(Ke(n.method||"GET",c)){const m=J(r,c.pathname),d=Ve(m),g=Xe(c.pathname).replace(/^\./,""),O=er[g];O&&l.setHeader("Content-Type",O),(u=e.static)!=null&&u.cacheControl&&l.setHeader("Cache-Control",e.static.cacheControl),d.on("error",p),d.pipe(l);return}return p()}catch(c){console.error(c),p(c)}}}}const ce="__RequestHandlers__",le="__RequestMiddleware__",xe="__filter__",Se="__execption__",ar=function(e){return(t="/")=>(r,o)=>{const a=Reflect.getMetadata(ce,r)??[];a.push({path:t,mod:e,key:o}),Reflect.defineMetadata(ce,a,r)}},Q=ar("get"),or=e=>(t,r)=>{const o=Reflect.getMetadata(le,t,r)??[];o.push(e),Reflect.defineMetadata(le,o,t,r)};class nr{constructor(){}find(t){return`get user ${t} ok`}}var sr=Object.defineProperty,ir=Object.getOwnPropertyDescriptor,cr=(e,t,r,o)=>{for(var a=o>1?void 0:o?ir(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&sr(t,r,a),a};class Ie{constructor(t){i(this,"find",function(t,r){console.log(this.userService);const o=t.query.uid;return this.userService.find(String(o))});this.userService=t,this.userService=new nr}}cr([Q(),or(async(e,t,r)=>{console.log(e.path),r()})],Ie.prototype,"find",2);class lr{constructor(){}sendEmailCode(t,r){}validateEmail(t){return pt(t)}token(){}}var pr=Object.defineProperty,ur=Object.getOwnPropertyDescriptor,Ue=(e,t,r,o)=>{for(var a=o>1?void 0:o?ur(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&pr(t,r,a),a};class he{constructor(t){this.authService=t,this.authService=new lr}login(){return"login"}register(){return"register"}}Ue([Q("/login")],he.prototype,"login",1);Ue([Q("/register")],he.prototype,"register",1);var fr=Object.defineProperty,dr=Object.getOwnPropertyDescriptor,me=(e,t,r,o)=>{for(var a=o>1?void 0:o?dr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&fr(t,r,a),a};class te{constructor(){i(this,"main",async function(t,r){const o=await oe(J(global.__client,"/index.html"),"utf-8");r.setHeader("content-type","text/html"),r.send(o)});i(this,"icon",async function(t,r){const o=await oe(J(global.__client,"./favicon.ico"),"utf-8");r.setHeader("content-type","image/x-icon"),r.send(o)});i(this,"react",async function(t,r){const o=await oe(J(global.__client,"./react.svg"),"utf-8");r.setHeader("content-type","image/svg+xml"),r.send(o)})}}me([Q("/")],te.prototype,"main",2);me([Q("/favicon.ico")],te.prototype,"icon",2);me([Q("/react.svg")],te.prototype,"react",2);const hr=[{path:"/",controller:te},{path:"/api",childrens:[{path:"/user",controller:Ie},{path:"/auth",controller:he}]}];class T{static async push(t){const r=new Date;console.log(`${r.getHours()}:${r.getMinutes()}:${r.getSeconds()} ${t}`)}static async log(t,r,o){console.log(`${new Date().toLocaleDateString()} [${r.toLocaleUpperCase()}] ${t}`)}static async run(t){console.log(await t())}}function Ne(e){var r;const t=Oe();for(const[o,a]of Object.entries(e)){const s=a.path;a.controller&&t.use(s,mr(a.controller,a.path)),(r=a.childrens)!=null&&r.length&&t.use(s,Ne(a.childrens))}return t}function mr(e,t){const r=Oe(),o=new e,a=Reflect.getMetadata(ce,o)??{};for(const[s,{path:n,key:l,mod:p}]of Object.entries(a)){const u=Reflect.getMetadata(le,o,l)??[];for(const[d,g]of Object.entries(u))r[p](n,g);T.push(`\x1B[34mCreate Route to { Use: ${t}, Mod: ${p.toLocaleUpperCase()}, Path: ${n}, handle: ${l}}\x1B[0m`);const c=Reflect.getMetadata(xe,o,l)??Reflect.getMetadata(xe,e),m=Reflect.getMetadata(Se,o,l)??Reflect.getMetadata(Se,e);r[p](n,async(d,g,O)=>{let b=null;try{b=await o[l](d,g,O),c&&(b=c(b,{Req:d,Res:g,Next:O}))}catch(A){b=m?m(A,{Req:d,Res:g,Next:O}):A}b&&g.send(b)})}return r}var gr=Object.defineProperty,yr=Object.getOwnPropertyDescriptor,re=(e,t,r,o)=>{for(var a=o>1?void 0:o?yr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&gr(t,r,a),a};let L=class{constructor(){i(this,"uid");i(this,"email");i(this,"phone")}};re([E()],L.prototype,"uid",2);re([f({type:"varchar",length:100})],L.prototype,"email",2);re([f({type:"varchar",length:100})],L.prototype,"phone",2);L=re([W()],L);var Fe=(e=>(e.Receipt="receipt",e.Shipped="shipped",e.Returnable="returnable",e))(Fe||{}),vr=Object.defineProperty,br=Object.getOwnPropertyDescriptor,I=(e,t,r,o)=>{for(var a=o>1?void 0:o?br(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&vr(t,r,a),a};let x=class{constructor(){i(this,"auid");i(this,"user");i(this,"name");i(this,"fun");i(this,"location");i(this,"phone")}};I([E()],x.prototype,"auid",2);I([Z(()=>v,e=>e.address)],x.prototype,"user",2);I([f({type:"varchar",length:100})],x.prototype,"name",2);I([f({type:"enum",enum:Fe})],x.prototype,"fun",2);I([f({type:"varchar",length:255})],x.prototype,"location",2);I([f({type:"varchar",length:255})],x.prototype,"phone",2);x=I([W()],x);var pe=(e=>(e.Shelves="shelves",e.Takedown="takedown",e.Remove="remove",e))(pe||{}),_r=Object.defineProperty,wr=Object.getOwnPropertyDescriptor,S=(e,t,r,o)=>{for(var a=o>1?void 0:o?wr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&_r(t,r,a),a};let w=class{constructor(){i(this,"gid");i(this,"user");i(this,"descibes");i(this,"state");i(this,"images");i(this,"cover");i(this,"dates");i(this,"price");i(this,"read");i(this,"transports");i(this,"address")}};S([E()],w.prototype,"gid",2);S([Z(()=>v,e=>e.goods)],w.prototype,"user",2);S([f({type:"varchar",length:500})],w.prototype,"descibes",2);S([f({type:"enum",enum:pe,default:pe.Shelves})],w.prototype,"state",2);S([f({type:"json"})],w.prototype,"images",2);S([f({type:"varchar",length:255})],w.prototype,"cover",2);S([f({type:"json"})],w.prototype,"dates",2);S([f({type:"json"})],w.prototype,"price",2);S([f({type:"varchar",length:100})],w.prototype,"read",2);S([f({type:"json"})],w.prototype,"transports",2);S([ue(()=>x),Te()],w.prototype,"address",2);w=S([W()],w);var Rr=Object.defineProperty,xr=Object.getOwnPropertyDescriptor,C=(e,t,r,o)=>{for(var a=o>1?void 0:o?xr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&Rr(t,r,a),a};let R=class{constructor(){i(this,"pid");i(this,"user");i(this,"path");i(this,"cover");i(this,"dates");i(this,"read");i(this,"collection");i(this,"link")}};C([E()],R.prototype,"pid",2);C([Z(()=>v,e=>e.posts)],R.prototype,"user",2);C([f({type:"varchar",length:100})],R.prototype,"path",2);C([f({type:"varchar",length:100})],R.prototype,"cover",2);C([f({type:"json"})],R.prototype,"dates",2);C([f({type:"varchar",length:100})],R.prototype,"read",2);C([f({type:"varchar",length:100})],R.prototype,"collection",2);C([f({type:"varchar",length:100})],R.prototype,"link",2);R=C([W()],R);var Sr=Object.defineProperty,Pr=Object.getOwnPropertyDescriptor,z=(e,t,r,o)=>{for(var a=o>1?void 0:o?Pr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&Sr(t,r,a),a};let $=class{constructor(){i(this,"cid");i(this,"user");i(this,"content");i(this,"date");i(this,"status")}};z([E()],$.prototype,"cid",2);z([Z(()=>v,e=>e.comment)],$.prototype,"user",2);z([f({type:"json"})],$.prototype,"content",2);z([f({type:"json"})],$.prototype,"date",2);z([f({type:"varchar",length:10,default:"push"})],$.prototype,"status",2);$=z([W()],$);var Or=Object.defineProperty,Tr=Object.getOwnPropertyDescriptor,G=(e,t,r,o)=>{for(var a=o>1?void 0:o?Tr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&Or(t,r,a),a};let D=class{constructor(){i(this,"ucid");i(this,"user");i(this,"type");i(this,"content");i(this,"date")}};G([E()],D.prototype,"ucid",2);G([ue(()=>v)],D.prototype,"user",2);G([f({type:"varchar",length:20})],D.prototype,"type",2);G([f({type:"int"})],D.prototype,"content",2);G([f({type:"varchar",length:100,default:`${new Date}`})],D.prototype,"date",2);D=G([W()],D);var $r=Object.defineProperty,Dr=Object.getOwnPropertyDescriptor,P=(e,t,r,o)=>{for(var a=o>1?void 0:o?Dr(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&$r(t,r,a),a};let v=class{constructor(){i(this,"buid");i(this,"uid");i(this,"avatar");i(this,"background");i(this,"describes");i(this,"link_tags");i(this,"address");i(this,"goods");i(this,"posts");i(this,"comment");i(this,"collection")}};P([E()],v.prototype,"buid",2);P([f({type:"int"})],v.prototype,"uid",2);P([f({type:"varchar",length:100})],v.prototype,"avatar",2);P([f({type:"varchar",length:100})],v.prototype,"background",2);P([f({type:"varchar",length:300})],v.prototype,"describes",2);P([f({type:"json"})],v.prototype,"link_tags",2);P([k(()=>x,e=>e.user)],v.prototype,"address",2);P([k(()=>w,e=>e.user)],v.prototype,"goods",2);P([k(()=>R,e=>e.user)],v.prototype,"posts",2);P([k(()=>$,e=>e.user)],v.prototype,"comment",2);P([ue(()=>D),Te()],v.prototype,"collection",2);v=P([W()],v);var jr=Object.defineProperty,Ar=Object.getOwnPropertyDescriptor,U=(e,t,r,o)=>{for(var a=o>1?void 0:o?Ar(t,r):t,s=e.length-1,n;s>=0;s--)(n=e[s])&&(a=(o?n(t,r,a):n(a))||a);return o&&a&&jr(t,r,a),a};let j=class{constructor(){i(this,"iuid");i(this,"uid");i(this,"name");i(this,"gender");i(this,"birthday");i(this,"create_data")}};U([E()],j.prototype,"iuid",2);U([f({type:"int"})],j.prototype,"uid",2);U([f({type:"varchar",length:100})],j.prototype,"name",2);U([f({type:"int"})],j.prototype,"gender",2);U([f({type:"varchar",length:100})],j.prototype,"birthday",2);U([f({type:"varchar",length:100,default:`${new Date}`})],j.prototype,"create_data",2);j=U([W()],j);const H=new ut({type:"mysql",host:"localhost",port:3306,username:"root",password:"123456",database:"zhao_wu",synchronize:!0,entities:[x,v,D,j,L,w,R,$],logging:!1});async function Mr(){T.push("正在连接数据库..."),await H.initialize(),T.push("数据库连接成功...")}H.getRepository(L);H.getRepository(v);H.getRepository(j);H.getRepository(x);H.getRepository(D);H.getRepository(w);H.getRepository(R);H.getRepository($);global.__filename=Pe(import.meta.url);global.__dirname=B(__filename,"../");global.__client=B(__dirname,"../client");global.__ssr=B(__dirname,"../ssr");const Cr=async()=>{T.push("正在初始化服务器...");const e=F();e.use(lt()),T.push("正在托管client静态资源..."),e.use("/assets",F.static(B(__dirname,"../client/assets"))),T.push("正在托管ssr静态资源..."),e.use("/build",F.static(B(__dirname,"./build"),{immutable:!0,maxAge:"1y"})),e.use(F.static(B(__dirname,"../ssr"),{redirect:!1})),T.push("正在加载ssr路由...");const{router:t,notFound:r}=rr({render:ct,qwikCityPlan:Ye});e.use(t),await Mr(),e.use(F.json()),e.use(F.urlencoded({extended:!0})),T.push("正在加载服务器路由..."),e.use(Ne(hr)),e.use(r),e.listen(3e3,Hr)};function Hr(){T.push(`当前服务器位于 ${process.env.DEV_ENV?"开发环境中":"生产环境中 "}`),T.push("\x1B[4mhttp://127.0.0.1:3000\x1B[0m")}Cr();
